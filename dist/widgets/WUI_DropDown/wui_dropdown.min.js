var WUI_DropDown=new function(){"use strict";var a={},b={dropdown:"wui-dropdown",item:"wui-dropdown-item",content:"wui-dropdown-content",selected:"wui-dropdown-selected",open:"wui-dropdown-open",on:"wui-dropdown-on"},c={width:"auto",height:24,ms_before_hiding:2e3,vertical:!1,vspacing:0,selected_id:0,on_item_selected:null},d=function(a){var b=a.ownerDocument,c=a.getBoundingClientRect(),d=b.body,e=b.documentElement,f=b.defaultView||b.parentWindow,g=f.pageYOffset||e.scrollTop||d.scrollTop,h=f.pageXOffset||e.scrollLeft||d.scrollLeft,i=e.clientTop||d.clientTop||0,j=e.clientLeft||d.clientLeft||0,k=c.top+g-i,l=c.left+h-j;return{top:Math.round(k),left:Math.round(l)}},e=function(a,c){var d,e=a.createElement("div"),f=null,g="";for(d=0;c.content_array.length>d;d+=1)g=c.content_array[d],f=a.createElement("div"),c.opts.vertical||f.classList.add("wui-dropdown-horizontal"),f.classList.add(b.item),f.innerHTML=g,f.dataset.index=d,e.appendChild(f),f.addEventListener("click",h,!1),g===c.content_array[c.selected_id]&&f.classList.add(b.selected);e.addEventListener("mouseover",i,!1),e.classList.add(b.content),e.dataset.linkedto=c.element.id,a.body.appendChild(e),c.floating_content=e},f=function(a,c,d){c.classList.remove(b.on),d.floating_content&&a.body.removeChild(d.floating_content),d.floating_content=null,d.close_timeout=null},g=function(c){c.preventDefault(),c.stopPropagation();var d=c.target,e=null,g=null;d.classList.contains(b.dropdown)&&(e=a[d.id],g=e.floating_content,g?g.classList.contains(b.open)&&f(c.target.ownerDocument,d,e):i(c))},h=function(c){c.preventDefault(),c.stopPropagation();var d,e,g=c.target,h=null,i=null;if(g.classList.contains(b.item)){for(h=g.parentElement,d=a[h.dataset.linkedto],i=h.getElementsByTagName("div"),e=0;i.length>e;e+=1)i[e].classList.remove(b.selected);g.classList.add(b.selected),d.selected_id=parseInt(g.dataset.index,10),d.target_element.lastElementChild.innerHTML=g.textContent,void 0!==d.opts.on_item_selected&&d.opts.on_item_selected(g.dataset.index),f(g.ownerDocument,d.target_element,d)}},i=function(c){c.preventDefault(),c.stopPropagation();var f=c.target,g=null,h=null,i=null,k=f.ownerDocument,l=k.defaultView||k.parentWindow;if(f.classList.contains(b.dropdown))g=a[f.id],null===g.floating_content&&(f.classList.add(b.on),e(k,g),i=g.floating_content,h=d(f),i.style.top=h.top-i.offsetHeight-g.opts.vspacing+"px",i.style.left=h.left+"px",i.classList.add(b.open),g.target_element=f);else if(f.classList.contains(b.content))g=a[f.dataset.linkedto];else{if(!f.classList.contains(b.item))return;g=a[f.parentElement.dataset.linkedto]}l.clearTimeout(g.close_timeout),f.addEventListener("mouseleave",j,!1)},j=function(c){c.preventDefault();var d=c.target,e=null,g=d.ownerDocument,h=g.defaultView||g.parentWindow;e=d.classList.contains(b.content)?a[d.dataset.linkedto]:d.classList.contains(b.item)?a[d.parentElement.dataset.linkedto]:a[d.id],e.close_timeout=h.setTimeout(f,e.opts.ms_before_hiding,g,e.target_element,e),d.removeEventListener("mouseleave",j,!1)};this.create=function(d,e,f){var h,j=document.getElementById(d),k={};if(void 0!==a[d])return void console.log("WUI_DropDown id '"+d+"' already created, aborting.");for(h in c)c.hasOwnProperty(h)&&(k[h]=c[h]);if(void 0!==e)for(h in e)e.hasOwnProperty(h)&&void 0!==c[h]&&(k[h]=e[h]);j.classList.add(b.dropdown),j.style.width=k.width,j.style.height=k.height;var l=document.createElement("div");l.classList.add("wui-dropdown-icon"),j.appendChild(l);var m=document.createElement("div");m.classList.add("wui-dropdown-text"),0!==f.length&&(m.innerHTML=f[k.selected_id]),j.appendChild(m),j.addEventListener("click",g,!1),j.addEventListener("mouseover",i,!1);var n={element:j,floating_content:null,selected_id:k.selected_id,content_array:f,opts:k,button_item:m,hover_count:0,target_element:null,close_timeout:null};return a[d]=n,d},this.destroy=function(b){var c,d=a[b];return void 0===d?void console.log("Element id '"+b+"' is not a WUI_DropDown, destroying aborted."):(c=d.element,f(document,c,d),c.parentElement.removeChild(c),void delete a[b])}};