var WUI_ToolBar=new function(){var a={},b={minimize_icon:"wui-toolbar-minimize-icon",maximize_icon:"wui-toolbar-maximize-icon",button:"wui-toolbar-button",minimize_group:"wui-toolbar-minimize-group",minimize_gr_v:"wui-toolbar-minimize-group-vertical",toggle:"wui-toolbar-toggle",toggle_on:"wui-toolbar-toggle-on",item:"wui-toolbar-item",dd_content:"wui-toolbar-dropdown-content",dd_item:"wui-toolbar-dropdown-item",dd_open:"wui-toolbar-dropdown-open"},c={item_hmargin:3,icon_width:32,icon_height:32,allow_groups_minimize:!1,vertical:!1},d=function(a){var b=a.getBoundingClientRect(),c=document.body,d=document.documentElement,e=window.pageYOffset||d.scrollTop||c.scrollTop,f=window.pageXOffset||d.scrollLeft||c.scrollLeft,g=d.clientTop||c.clientTop||0,h=d.clientLeft||c.clientLeft||0,i=b.top+e-g,j=b.left+f-h;return{top:Math.round(i),left:Math.round(j)}},e=function(c,d){return void 0!==d?a[d]:c.classList.contains(b.minimize_icon)||c.classList.contains(b.maximize_icon)?a[c.parentElement.id]:a[c.parentElement.parentElement.id]},f=function(a,b,c){if(void 0!==a.on_click&&null!==a.on_click){var d={type:b};void 0!==c&&(d.state=c),a.on_click(d)}},g=function(a,c,d){var g,h=null,i=!1,j=0;h=e(a,c);var k=h.tools[a.dataset.tool_id];if("1"===k.element.dataset.on?(k.element.dataset.on=0,k.element.title=k.tooltip,void 0!==k.icon&&(k.element.classList.add(k.icon),k.element.classList.remove(k.toggled_icon))):(k.element.dataset.on=1,void 0!==k.tooltip_toggled&&(k.element.title=k.tooltip_toggled),void 0!==k.toggled_icon&&(k.element.classList.add(k.toggled_icon),k.element.classList.remove(k.icon)),i=!0),"none"!==k.toggled_style&&k.element.classList.toggle(b.toggle_on),g=a.dataset.toggle_group,void 0!==g)for(j=0;h.tools.length>j;j+=1){var l=h.tools[j];if(g===l.element.dataset.toggle_group&&l.element!==a){if("0"===l.element.dataset.on)continue;l.element.dataset.on="0",l.element.classList.remove(b.toggle_on),void 0!==l.toggled_icon&&l.element.classList.remove(l.toggled_icon),void 0!==l.icon&&l.element.classList.add(l.icon),(d||void 0===d)&&f(l,"toggle",!1)}}(d===!0||void 0===d)&&f(k,"toggle",i)},h=function(c){c.preventDefault(),c.stopPropagation();var d=c.target,e=d.parentElement,f=a[e.dataset.linkedto_tb],g=f.tools[parseInt(e.dataset.linkedto_tool_index,10)],h=parseInt(d.dataset.index,10),i=g.items[h];void 0!==i.on_click&&(i.on_click(),g.element.classList.remove(b.toggle_on),e.classList.remove(b.dd_open))},i=function(a,c){c.classList.remove(b.dd_open),a.element.classList.remove(b.toggle_on)},j=function(a,b){var c=function(){i(a,b),window.removeEventListener("click",c)};return c},k=function(a){a.preventDefault(),a.stopPropagation();var c=a.target;if(c.classList.contains(b.minimize_group)||c.classList.contains(b.minimize_gr_v))return void l(c);if(c.classList.contains(b.toggle))return void g(c);var h=null,k=null,m=null,n=null;if(n=e(c),h=n.tools[c.dataset.tool_id],"dropdown"===h.type){if(k=h.floating_content,c.classList.contains(b.toggle_on))return void i(h,k);var o=h.element;o.classList.add(b.toggle_on),m=d(c),"tb_item"===h.dd_items_width&&(k.style.width=c.offsetWidth+"px"),"s"===h.orientation?(k.style.top=m.top+c.offsetHeight+"px",k.style.left=m.left+"px"):"sw"===h.orientation?(k.style.top=m.top+c.offsetHeight+"px",k.style.left=m.left-k.offsetWidth+"px"):"nw"===h.orientation?(k.style.top=m.top-k.offsetHeight+c.offsetHeight+"px",k.style.left=m.left-k.offsetWidth+"px"):"se"===h.orientation?(k.style.top=m.top+c.offsetHeight+"px",k.style.left=m.left+c.offsetWidth+"px"):"ne"===h.orientation?(k.style.top=m.top-k.offsetHeight+c.offsetHeight+"px",k.style.left=m.left+c.offsetWidth+"px"):(k.style.top=m.top-k.offsetHeight+"px",k.style.left=m.left+"px"),k.classList.add(b.dd_open),a.stopPropagation&&a.stopPropagation(),window.addEventListener("click",j(h,k),!1)}else f(h,"click")},l=function(a){var c,d=a.nextSibling,f=d.getElementsByTagName("div"),g=null,h=e(a);if(a.classList.contains(b.minimize_icon))for(a.classList.add(b.maximize_icon),a.classList.remove(b.minimize_icon),a.title="Maximize group",d.style.width="0",d.style.height="0",c=0;f.length>c;c+=1)g=f[c],g.style.minWidth="0",g.style.minHeight="0";else for(a.classList.add(b.minimize_icon),a.classList.remove(b.maximize_icon),a.title="Minimize group",d.style.width="auto",d.style.height="auto",c=0;f.length>c;c+=1)g=f[c],g.style.minWidth=h.opts.icon_width+"px",g.style.minHeight=h.opts.icon_height+"px"};this.create=function(d,e,f){var i,j=document.getElementById(d),l=null,m=null,n=null,o=null,p={};if(void 0!==a[d])return void console.log("WUI_Toolbar id '"+d+"' already created, aborting.");for(i in c)c.hasOwnProperty(i)&&(p[i]=c[i]);if(void 0!==f)for(i in f)f.hasOwnProperty(i)&&void 0!==c[i]&&(p[i]=f[i]);a[d]={tools:[],opts:p},j.classList.add("wui-toolbar");var q="wui-toolbar-group",r=b.item,s="wui-toolbar-spacer",t=b.minimize_group;p.vertical?(j.classList.add("wui-toolbar-vertical"),q="wui-toolbar-group-vertical",r+=" wui-toolbar-item-vertical",s="wui-toolbar-spacer-vertical",t=b.minimize_gr_v,j.style.maxWidth=p.icon_width+4+"px"):j.style.maxHeight=p.icon_height+4+"px",t=b.button+" "+b.minimize_icon+" "+t,j.addEventListener("click",k,!1);for(n in e)if(e.hasOwnProperty(n)){null!==o&&(m=document.createElement("div"),m.className=s,j.appendChild(m)),p.allow_groups_minimize&&(m=document.createElement("div"),m.className=t,m.title="Minimize group",j.appendChild(m)),l=e[n];var u=document.createElement("div");u.className=q,p.vertical?u.style.maxWidth=p.icon_width+"px":u.style.maxHeight=p.icon_height+"px";for(var v=0;l.length>v;v+=1){var w,x=l[v],y=document.createElement("div"),z={element:y,on_click:x.on_click,icon:x.icon,items:[],tooltip:"",type:x.type,dd_items_width:x.dropdown_items_width,orientation:x.orientation},A=a[d].tools.length;if(y.className=r,y.style.minWidth=p.icon_width+"px",y.style.minHeight=p.icon_height+"px",y.style.marginLeft=p.item_hmargin+"px",y.style.marginRight=p.item_hmargin+"px",y.style.backgroundSize=p.icon_width-4+"px "+(p.icon_height-4)+"px",u.appendChild(y),a[d].tools.push(z),y.dataset.tool_id=A,z.tooltip=x.tooltip,void 0!==x.tooltip&&(y.title=x.tooltip),void 0!==x.text&&(y.innerHTML=x.text,y.style.lineHeight=p.icon_height+"px",y.classList.add("wui-toolbar-text"),void 0!==x.icon&&(y.style.paddingLeft=p.icon_width+2+"px",y.style.backgroundPosition="left center")),void 0!==x.icon&&y.classList.add(x.icon),"toggle"===x.type)y.classList.add(b.toggle),z.toggled_icon=x.toggled_icon,z.tooltip_toggled=x.tooltip_toggled,z.toggled_style=x.toggled_style,void 0!==x.toggle_group&&(y.dataset.toggle_group=x.toggle_group),x.toggle_state&&(y.dataset.on="0",g(y,d,!0));else if("dropdown"===x.type){y.classList.add(b.button);var B=document.createElement("div");if(void 0!==x.items)for(w=0;x.items.length>w;w+=1){var C=x.items[w],D=document.createElement("div");x.vertical||D.classList.add("wui-toolbar-dropdown-horizontal"),D.classList.add(b.dd_item),D.innerHTML=C.title,D.dataset.index=w,B.appendChild(D),z.items.push({element:D,on_click:C.on_click})}B.addEventListener("click",h,!1),z.floating_content=B,B.style.width=z.dd_items_width+"px",B.classList.add(b.dd_content),B.dataset.linkedto_tb=d,B.dataset.linkedto_tool_index=A,document.body.appendChild(B)}else y.classList.add(b.button)}j.appendChild(u),o=l}return d},this.toggle=function(b,c,d){var e=a[b];return void 0===e?void("undefined"!=typeof console&&console.log('Cannot toggle, WUI toolbar "'+b+'" was not created.')):void g(e.tools[c].element,b,d)},this.getItemElement=function(b,c){var d=a[b];return void 0===d?void("undefined"!=typeof console&&console.log('getItemElement problem, WUI toolbar "'+b+'" was not created.')):d.tools[c].element}};
