var WUI=new function(){var a=[WUI_DropDown,WUI_Dialog,WUI_RangeSlider,WUI_ToolBar,WUI_Tabs];this.dispatchEvent=function(b,c){for(var d=0;a.length>d;d+=1)a[d].triggerEvent(b,c)}},WUI_Dialog=new function(){var a={},b=null,c=0,d=0,e={btn:"wui-dialog-btn",btn_close:"wui-dialog-close",minimize:"wui-dialog-minimize",maximize:"wui-dialog-maximize",header:"wui-dialog-header",transition750:"wui-dialog-transition-750",draggable:"wui-dialog-draggable"},f={title:"",width:"80%",height:"40%",closable:!0,minimizable:!1,draggable:!1,halign:"none",valign:"none",top:"0px",bottom:"0px",left:"0px",right:"0px",use_event_listener:!0},g=function(a){var b=a.target.parentElement.parentElement;b.classList.toggle(e.transition750)},h=function(a){var b=a.target,c=a.target.parentElement.parentElement;b.classList.toggle(e.minimize),b.classList.toggle(e.maximize),c.classList.toggle("wui-dialog-minimized")},i=function(e){var f=e.clientX-c,g=e.clientY-d,h=a[b.id];b.style.left=f+"px",b.style.top=g+"px","right"===h.opts.halign?b.style.right=f+"px":"center"===h.opts.halign&&(b.style.right=-f+"px"),"bottom"===h.opts.valign?b.style.bottom=g+"px":"center"===h.opts.valign&&(b.style.bottom=-g+"px")},j=function(){b=null,document.body.style.cursor="default",window.removeEventListener("mousemove",i,!0)},k=function(f){if(b=f.target.parentElement,0===f.button&&!b.classList.contains(e.maximize)&&b.classList.contains(e.draggable)){var g=0,h=0,j=null;for(var k in a)a.hasOwnProperty(k)&&(j=a[k].dialog,isNaN(j.style.zIndex)||(h=parseInt(j.style.zIndex,10),h>g&&(g=h),h>1e5&&(h-=1e5)));b.style.zIndex=g+1,document.body.style.cursor="move",c=f.clientX-parseInt(b.style.left,10),d=f.clientY-parseInt(b.style.top,10),window.addEventListener("mousemove",i,!0)}};this.triggerEvent=function(a,b){var c=a.target,d=a.type;if(void 0!==b&&(d=b),"click"===d){if(c.classList.contains(e.btn_close))return g(a),!0;if(c.classList.contains(e.minimize)||c.classList.contains(e.maximize))return h(a),!0}else if("mousedown"===d&&c.classList.contains(e.header))return k(a),!0;return!1},this.create=function(b,c){var d,i={};for(d in f)f.hasOwnProperty(d)&&(i[d]=f[d]);if(void 0!==c)for(d in c)c.hasOwnProperty(d)&&void 0!==f[d]&&(i[d]=c[d]);var l=document.getElementById(b),m=document.createElement("div"),n=null,o=null,p=null;if(null===l)return void("undefined"!=typeof console&&console.log('WUI dialog create, unknow element with id "'+b+'".'));var q=l.firstElementChild;return null===q&&(q=document.createElement("div"),l.appendChild(q)),l.style.width=i.width,l.style.height=i.height,"center"===i.halign?(l.style.left="0",l.style.right="0"):"right"===i.halign?l.style.right="0":"left"===i.halign?l.style.left="0":(l.style.left=i.left,l.style.right=i.right),"center"===i.valign?(l.style.top="0",l.style.bottom="0"):"bottom"===i.valign?l.style.bottom="0":"top"===i.valign?l.style.top="0":(l.style.top=i.top,l.style.bottom=i.bottom),l.classList.add("wui-dialog"),q.classList.add("wui-dialog-content"),m.className=e.header,q.style.height=l.offsetHeight-32+"px",""!==i.title&&(p=document.createElement("div"),p.className="wui-dialog-title",p.innerHTML=i.title,m.appendChild(p)),i.closable&&(n=document.createElement("div"),n.className=e.btn+" "+e.btn_close,i.use_event_listener&&n.addEventListener("click",g,!1),m.appendChild(n)),i.minimizable&&(o=document.createElement("div"),o.className=e.btn+" "+e.minimize,i.use_event_listener&&o.addEventListener("click",h,!1),m.appendChild(o)),i.draggable&&(l.classList.toggle(e.draggable),i.use_event_listener&&m.addEventListener("mousedown",k,!1),window.addEventListener("mouseup",j,!1)),l.insertBefore(m,q),a[b]={dialog:l,minimized_id:-1,bottom_pos:l.style.bottom,opts:i},b},this.open=function(b){return void 0===a[b]?void("undefined"!=typeof console&&console.log('Cannot open WUI dialog "'+b+'".')):void a[b].dialog.classList.remove(e.transition750)}},WUI_DropDown=new function(){var a={},b={dropdown:"wui-dropdown",item:"wui-dropdown-item",content:"wui-dropdown-content",selected:"wui-dropdown-selected",transition:"wui-dropdown-transition"},c={width:"auto",height:24,ms_before_hiding:2e3,vertical:!1,vspacing:0,selected_id:0,on_item_selected:null,use_event_listener:!0},d=function(a){var b=a.getBoundingClientRect(),c=document.body,d=document.documentElement,e=window.pageYOffset||d.scrollTop||c.scrollTop,f=window.pageXOffset||d.scrollLeft||c.scrollLeft,g=d.clientTop||c.clientTop||0,h=d.clientLeft||c.clientLeft||0,i=b.top+e-g,j=b.left+f-h;return{top:Math.round(i),left:Math.round(j)}},e=function(a){a.floating_content.classList.add(b.transition),a.element.classList.remove("wui-dropdown-on"),a.close_timeout=null},f=function(c){var d,e=c.target,f=a[e.id],g=null,h=null;if(e.classList.contains(b.item)){for(g=e.parentElement,f=a[g.dataset.linkedto],h=g.getElementsByTagName("div"),d=0;h.length>d;d+=1)h[d].classList.remove(b.selected);e.classList.add(b.selected),f.button_item.innerHTML=e.textContent,void 0!==f.opts.on_item_selected&&f.opts.on_item_selected(e.dataset.index)}},g=function(c){var e=c.target,f=a[e.id],g=null,i=null;if(e.classList.contains(b.dropdown))i=f.floating_content,f.element.classList.add("wui-dropdown-on"),g=d(e),i.style.top=g.top-i.offsetHeight-f.opts.vspacing+"px",i.style.left=g.left+"px",i.classList.remove(b.transition);else if(e.classList.contains(b.content))f=a[e.dataset.linkedto];else{if(!e.classList.contains(b.item))return;f=a[e.parentElement.dataset.linkedto]}window.clearTimeout(f.close_timeout),e.addEventListener("mouseleave",h,!1)},h=function(c){var d=c.target,f=null;f=d.classList.contains(b.content)?a[d.dataset.linkedto]:d.classList.contains(b.item)?a[d.parentElement.dataset.linkedto]:a[d.id],f.close_timeout=window.setTimeout(e,f.opts.ms_before_hiding,f),d.removeEventListener("mouseleave",h,!1)};this.triggerEvent=function(a,b){var c=a.type;return void 0!==b&&(c=b),"mouseover"===c?g(a):"click"===c&&f(a),!1},this.create=function(d,e,h){var i,j=document.getElementById(d),k=null,l="",m=[],n={},o=0;for(i in c)c.hasOwnProperty(i)&&(n[i]=c[i]);if(void 0!==e)for(i in e)e.hasOwnProperty(i)&&void 0!==c[i]&&(n[i]=e[i]);j.classList.add(b.dropdown),j.style.width=n.width,j.style.height=n.height;var p=document.createElement("div");p.classList.add("wui-dropdown-icon"),j.appendChild(p);var q=document.createElement("div");q.classList.add("wui-dropdown-text"),0!==h.length&&(q.innerHTML=h[n.selected_id]),j.appendChild(q);var r=document.createElement("div");for(n.use_event_listener&&(j.addEventListener("mouseover",g,!1),r.addEventListener("mouseover",g,!1)),o=0;h.length>o;o+=1)l=h[o],k=document.createElement("div"),n.vertical||k.classList.add("wui-dropdown-horizontal"),k.classList.add(b.item),k.innerHTML=l,k.dataset.index=o,r.appendChild(k),m.push(k),n.use_event_listener&&(k.addEventListener("click",f,!1),k.addEventListener("mouseover",g,!1)),l===h[n.selected_id]&&k.classList.add(b.selected);r.classList.add(b.content),r.classList.add(b.transition),r.dataset.linkedto=d,document.body.appendChild(r);var s={element:j,floating_content:r,items:m,opts:n,button_item:q,hover_count:0,close_timeout:null};a[d]=s}},WUI_RangeSlider=new function(){var a={},b=null,c=null,d=null,e={hook:"wui-rangeslider-hook",bar:"wui-rangeslider-bar",filler:"wui-rangeslider-filler"},f={width:148,height:8,title:"",title_min_width:0,value_min_width:0,min:0,max:1,step:.01,scroll_step:.01,vertical:!1,title_on_top:!1,on_change:null,default_value:.5,use_event_listener:!0},g=function(a){var b=a.getBoundingClientRect(),c=document.body,d=document.documentElement,e=window.pageYOffset||d.scrollTop||c.scrollTop,f=window.pageXOffset||d.scrollLeft||c.scrollLeft,g=d.clientTop||c.clientTop||0,h=d.clientLeft||c.clientLeft||0,i=b.top+e-g,j=b.left+f-h;return{top:Math.round(i),left:Math.round(j)}},h=function(a,b){null!==a&&a(b)},i=function(a,b){var c=""+a,d=c.indexOf("."),e=-1==d?c.length:1+d+b,f=c.substr(0,e),g=isNaN(f)?0:f;return parseFloat(g)},j=function(a){return a.classList.contains(e.hook)?a:a.classList.contains(e.filler)?a.firstElementChild:a.firstElementChild.firstElementChild},k=function(a,b){var c=a.element,d=c.childNodes[2],e=c.childNodes[1],f=e.firstElementChild,g=f.firstElementChild,h=a.opts.width,j=a.opts.height,k=Math.abs((b-a.opts.min)/a.opts.range);a.opts.vertical?(k=Math.round(k*e.offsetHeight),f.style.position="absolute",f.style.bottom="0",f.style.width="100%",f.style.height=k+"px",g.style.marginTop=-h+"px",g.style.marginLeft=-h/2-1+"px",g.style.width=2*h+"px",g.style.height=2*h+"px",d.style.marginTop="13px"):(k=Math.round(k*h),f.style.width=k+"px",f.style.height="100%",g.style.left=k+"px",g.style.marginTop=-j/2+"px",g.style.marginLeft=-j+"px",g.style.width=2*j+"px",g.style.height=2*j+"px"),d.value=i(b,4),a.value=b},l=function(a){if(null!==d){var e=c.element.lastElementChild,f=d.parentElement,j=f.parentElement,k=g(j),l=j.offsetWidth,m=0;if(c.opts.vertical?(l=j.offsetHeight,m=Math.round((k.top+j.offsetHeight-a.clientY)/c.opts.step)*c.opts.step):m=Math.round((a.clientX-k.left)/c.opts.step)*c.opts.step,m>l?(m=l,b=c.opts.max):0>m?(m=0,b=c.opts.min):b=Math.round((c.opts.min+m/l*c.opts.range)/c.opts.step)*c.opts.step,c.value===b)return;c.value=b,e.value=i(b,4),c.opts.vertical?f.style.height=m+"px":(f.style.width=m+"px",d.style.left=m+"px"),h(c.opts.on_change,b)}},m=function(){d.classList.remove("wui-rangeslider-hook-focus"),d=null,c=null,document.body.style.cursor="default",window.removeEventListener("mouseup",m,!1),window.removeEventListener("mousemove",l,!1)},n=function(b){if(0===b.button){var e=null;d=j(b.target),d.classList.add("wui-rangeslider-hook-focus"),e=d.parentElement.parentElement.parentElement,c=a[e.id],document.body.style.cursor="pointer",l(b),window.addEventListener("mousemove",l,!1),window.addEventListener("mouseup",m,!1)}},o=function(b){var d=b.target,e=d.parentElement.parentElement.parentElement,f=a[e.id],g=f.opts.default_value;k(f,g),h(c.opts.on_change,g)},p=function(b){var d=j(b.target),e=d.parentElement.parentElement.parentElement,f=a[e.id],g=b.wheelDelta?b.wheelDelta/40:b.detail?-b.detail:0,i=f.value;g>=0?i+=f.opts.scroll_step:i-=f.opts.scroll_step,i>f.opts.max?i=f.opts.max:f.opts.min>i&&(i=f.opts.min),k(f,i),h(c.opts.on_change,i)},q=function(b){if(!b.target.validity||b.target.validity.valid){var d=b.target.parentElement.childNodes[1];if(void 0!==d){var e=j(d),f=e.parentElement.parentElement.parentElement,g=a[f.id];k(g,b.target.value),h(c.opts.on_change,b.target.value)}}};this.triggerEvent=function(a,b){var c=a.target,d=a.type;if(void 0!==b&&(d=b),"mousedown"===d){if(c.classList.contains(e.hook)||c.classList.contains(e.bar)||c.classList.contains(e.filler))return n(a),!0}else if("dblclick"===d){if(c.classList.contains(e.hook))return o(a),!0}else if("mousewheel"===d||"DOMMouseScroll"===d){if(c.classList.contains(e.hook)||c.classList.contains(e.bar)||c.classList.contains(e.filler))return p(a),!0}else if("input"===d)return q(a),!0;return!1},this.create=function(b,c){var d,g=document.getElementById(b),h={};for(d in f)f.hasOwnProperty(d)&&(h[d]=f[d]);if(void 0!==c){for(d in c)c.hasOwnProperty(d)&&void 0!==f[d]&&(h[d]=c[d]);void 0!==c.max&&(h.range=c.max),void 0!==c.step&&(h.step=c.step,void 0===c.scroll_step&&(h.scroll_step=h.step)),void 0!==c.title_on_top?h.title_on_top=c.title_on_top:h.vertical&&(h.title_on_top=!0),void 0!==c.default_value?h.default_value=c.default_value:void 0!==c.min&&void 0!==c.max&&(h.default_value=h.min+h.max/2)}0>h.min&&(h.range=h.max-h.min),a[b]=null,g.classList.add("wui-rangeslider"),h.title_on_top&&g.classList.add("wui-rangeslider-title-ontop");var i=document.createElement("div"),j=document.createElement("div"),l=document.createElement("div"),m=document.createElement("div"),r=document.createElement("div"),s=document.createElement("input"),t={element:g,opts:h,value:h.default_value};i.innerHTML=h.title,s.setAttribute("value",h.default_value),s.setAttribute("type","number"),s.setAttribute("min",h.min),s.setAttribute("max",h.max),s.setAttribute("step",h.step),s.classList.add("wui-rangeslider-input"),r.classList.add("wui-rangeslider-value"),i.classList.add("wui-rangeslider-title"),j.classList.add(e.bar),l.classList.add(e.filler),m.classList.add(e.hook),i.style.minWidth=h.title_min_width+"px",r.style.minWidth=h.value_min_width+"px",s.style.minWidth=h.value_min_width+"px",j.style.width=h.width+"px",j.style.height=h.height+"px",j.appendChild(l),l.appendChild(m),g.appendChild(i),g.appendChild(j),g.appendChild(s),k(t,h.default_value),h.use_event_listener&&(j.addEventListener("mousedown",n,!1),m.addEventListener("dblclick",o,!1),s.addEventListener("input",q,!1),j.addEventListener("mousewheel",p,!1),j.addEventListener("DOMMouseScroll",p,!1)),a[b]=t}},WUI_Tabs=new function(){var a={},b={enabled:"wui-tab-enabled",disabled:"wui-tab-disabled",display_none:"wui-tab-display-none",tab:"wui-tab",tab_content:"wui-tab-content"},c={on_tab_click:null,use_event_listener:!0},d=function(c){var d=c.target,e=d.parentElement,f=e.nextElementSibling.nextElementSibling,g=e.parentElement.id,h=0,i=null,j=0;for(j=0;e.childElementCount>j;j+=1)i=e.children[j],i.classList.remove(b.enabled),i.classList.add(b.disabled),i===d&&(h=j);for(j=0;f.childElementCount>j;j+=1)i=f.children[j],i.classList.remove(b.display_none),h!==j&&i.classList.add(b.display_none);c.target.classList.remove(b.disabled),c.target.classList.toggle(b.enabled),void 0!==a[g]&&a[g](h)};this.triggerEvent=function(a,c){var e=a.target,f=a.type;return void 0!==c&&(f=c),"click"===f&&e.classList.contains(b.tab)?(d(a),!0):!1},this.create=function(e,f){var g,h=document.getElementById(e),i=h.firstElementChild,j=document.createElement("div"),k=i.nextElementSibling,l=i.children[0],m={},n=0;for(g in c)c.hasOwnProperty(g)&&(m[g]=c[g]);if(void 0!==f)for(g in f)f.hasOwnProperty(g)&&void 0!==c[g]&&(m[g]=f[g]);j.className="wui-tabs-underline",h.insertBefore(j,k),i.classList.add("wui-tabs");var o=i.childElementCount;for(n=0;o>n;n+=1){var p=i.children[n];p.classList.add("wui-tab"),p!==l&&p.classList.add(b.disabled),m.use_event_listener&&p.addEventListener("click",d,!1)}l.classList.add(b.enabled),l.classList.add("wui-first-tab"),k.classList.add("wui-tabs-content");var q=k.childElementCount;for(k.style.height=k.offsetHeight-32+"px",k.children[0].classList.add(b.tab_content),n=1;q>n;n+=1){var r=k.children[n];r.classList.add(b.tab_content),r.classList.add(b.display_none)}return void 0===a[e]&&(a[e]=m.on_tab_click),e},this.getContentElement=function(a,b){var c=document.getElementById(a),d=c.firstElementChild.nextElementSibling.nextElementSibling;return d.children[b]},this.getTabName=function(a,b){var c=this.getContentElement(a,b);return c.getAttribute("data-group-name")}},WUI_ToolBar=new function(){var a={},b={minimize_icon:"wui-toolbar-minimize-icon",maximize_icon:"wui-toolbar-maximize-icon",button:"wui-toolbar-button",minimize_group:"wui-toolbar-minimize-group",toggle:"wui-toolbar-toggle",toggle_on:"wui-toolbar-toggle-on"},c={item_hmargin:3,icon_width:32,icon_height:32,allow_groups_minimize:!1,vertical:!1,use_event_listener:!0},d=function(c,d){return void 0!==d?a[d]:c.classList.contains(b.minimize_icon)||c.classList.contains(b.maximize_icon)?a[c.parentElement.id]:a[c.parentElement.parentElement.id]},e=function(a,b,c){if(void 0!==a.onClick&&null!==a.onClick){var d={type:b};void 0!==c&&(d.state=c),a.onClick(d)}},f=function(a,c){var f,g=a.target,h=null,i=!1,j=0;h=d(g,c);var k=h.tools[g.dataset.tool_id];if("1"===k.element.dataset.on?(k.element.dataset.on=0,k.element.title=k.tooltip,void 0!==k.icon&&(k.element.classList.add(k.icon),k.element.classList.remove(k.toggled_icon))):(k.element.dataset.on=1,void 0!==k.tooltip_toggled&&(k.element.title=k.tooltip_toggled),void 0!==k.toggled_icon&&(k.element.classList.add(k.toggled_icon),k.element.classList.remove(k.icon)),i=!0),"none"!==k.toggled_style&&k.element.classList.toggle(b.toggle_on),f=g.dataset.toggle_group,void 0!==f)for(j=0;h.tools.length>j;j+=1){var l=h.tools[j];if(f===l.element.dataset.toggle_group&&l.element!==g){if("0"===l.element.dataset.on)continue;l.element.dataset.on="0",l.element.classList.remove(b.toggle_on),void 0!==l.toggled_icon&&l.element.classList.remove(l.toggled_icon),void 0!==l.icon&&l.element.classList.add(l.icon),e(l,"toggle",!1)}}e(k,"toggle",i)},g=function(a,b){var c=a.target,f=null;f=d(c,b);var g=f.tools[c.dataset.tool_id];e(g,"click")},h=function(a){var c,e=a.target,f=e.nextSibling,g=f.getElementsByTagName("div"),h=null,i=null;if(h=d(e),e.classList.contains(b.minimize_icon))for(e.classList.add(b.maximize_icon),e.classList.remove(b.minimize_icon),e.title="Maximize group",f.style.width="0",f.style.height="0",c=0;g.length>c;c+=1)i=g[c],i.style.minWidth="0",i.style.minHeight="0";else for(e.classList.add(b.minimize_icon),e.classList.remove(b.maximize_icon),e.title="Minimize group",f.style.width="auto",f.style.height="auto",c=0;g.length>c;c+=1)i=g[c],i.style.minWidth=h.opts.icon_width+"px",i.style.minHeight=h.opts.icon_height+"px"};this.triggerEvent=function(a,c){var d=a.target,e=a.type;if(void 0!==c&&(e=c),"click"===e){if(d.classList.contains(b.toggle))return f({target:d}),!0;if(d.classList.contains(b.minimize_group)||d.classList.contains("wui-toolbar-minimize-group-vertical"))return h({target:d}),!0;if(d.classList.contains(b.button))return g({target:d}),!0}return!1},this.create=function(d,e,i){var j,k=document.getElementById(d),l=null,m=null,n=null,o=null,p={};for(j in c)c.hasOwnProperty(j)&&(p[j]=c[j]);if(void 0!==i)for(j in i)i.hasOwnProperty(j)&&void 0!==c[j]&&(p[j]=i[j]);a[d]={tools:[],opts:p},k.classList.add("wui-toolbar");var q="wui-toolbar-group",r="wui-toolbar-item",s="wui-toolbar-spacer",t=b.minimize_group;p.vertical&&(k.classList.add("wui-toolbar-vertical"),q="wui-toolbar-group-vertical",r+=" wui-toolbar-item-vertical",s="wui-toolbar-spacer-vertical",t="wui-toolbar-minimize-group-vertical"),t=b.button+" "+b.minimize_icon+" "+t;for(n in e)if(e.hasOwnProperty(n)){null!==o&&(m=document.createElement("div"),m.className=s,k.appendChild(m)),p.allow_groups_minimize&&(m=document.createElement("div"),m.className=t,m.title="Minimize group",k.appendChild(m),p.use_event_listener&&m.addEventListener("click",h,!1)),l=e[n];var u=document.createElement("div");u.className=q;for(var v=0;l.length>v;v+=1){var w=l[v],x=document.createElement("div"),y={element:x,onClick:w.onClick,icon:w.icon},z=a[d].tools.length;x.className=r,x.style.minWidth=p.icon_width+"px",x.style.minHeight=p.icon_height+"px",x.style.marginLeft=p.item_hmargin+"px",x.style.marginRight=p.item_hmargin+"px",x.style.backgroundSize=p.icon_width-4+"px "+(p.icon_height-4)+"px",u.appendChild(x),a[d].tools.push(y),x.dataset.tool_id=z,y.tooltip=w.tooltip,void 0!==w.tooltip&&(x.title=w.tooltip),void 0!==w.text&&(x.innerHTML=w.text,x.style.lineHeight=p.icon_height+"px",x.classList.add("wui-toolbar-text")),"toggle"===w.type?(x.classList.add(b.toggle),y.toggled_icon=w.toggled_icon,y.tooltip_toggled=w.tooltip_toggled,y.toggled_style=w.toggled_style,void 0!==w.toggle_group&&(x.dataset.toggle_group=w.toggle_group),w.toggle_state&&(x.dataset.on="0",f({target:x},d)),p.use_event_listener&&x.addEventListener("click",f,!1)):(x.classList.add(b.button),p.use_event_listener&&x.addEventListener("click",g,!1)),void 0!==w.icon&&x.classList.add(w.icon)}k.appendChild(u),o=l}return d}};